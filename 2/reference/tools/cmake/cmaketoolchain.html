



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CMakeToolchain &mdash; conan 2.0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/conan-favicon.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  


  
    <link rel="stylesheet" href="../../../_static/css/signup.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/_static/graphviz.css" type="text/css" />
  

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../../_static/css/search.css" type="text/css" />
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="conan 2.0.1 documentation" href="../../../index.html"/>
        <link rel="up" title="conan.tools.cmake" href="../cmake.html"/>
        <link rel="next" title="CMake" href="cmake.html"/>
        <link rel="prev" title="CMakeDeps" href="cmakedeps.html"/>

 <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WK44ZFM');</script>
<!-- End Google Tag Manager -->
 



</script>


  

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/logo_docs_v2.png" class="logo" />
          
          </a>

            

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew.html">What’s new in Conan 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../commands.html">Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile.html">conanfile.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile_txt.html">conanfile.txt</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tools.html">Recipe tools</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../cmake.html">conan.tools.cmake</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cmakedeps.html">CMakeDeps</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">CMakeToolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="cmake.html">CMake</a></li>
<li class="toctree-l4"><a class="reference internal" href="cmake_layout.html">cmake_layout</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gnu.html">conan.tools.gnu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apple.html">conan.tools.apple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../env.html">conan.tools.env</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build.html">conan.tools.build</a></li>
<li class="toctree-l3"><a class="reference internal" href="../files.html">conan.tools.files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../meson.html">conan.tools.meson</a></li>
<li class="toctree-l3"><a class="reference internal" href="../system.html">conan.tools.system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../microsoft.html">conan.tools.microsoft</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scm.html">conan.tools.scm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../layout.html">conan.tools.layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intel.html">conan.tools.intel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../android.html">conan.tools.android</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../config_files.html">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions.html">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../environment.html">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conan_server.html">Conan Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

            
          
          <div class="dark_newsletter-div">
             <p><a href="https://conan.io/#signUp" target="_blank">Sign up for release updates</a></p>
          </div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">conan</a>
        
      </nav>


      
      <script>
        var reldir = "../../../index.html".replace("index.html","").replace("#", "");
      </script>
      <div class="wy-nav-content">
        <div class="rst-content">
                 
          















<div role="navigation" aria-label="breadcrumbs navigation" id="breadcrumbs">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../reference.html">Reference</a> &raquo;</li>
        
          <li><a href="../../tools.html">Recipe tools</a> &raquo;</li>
        
          <li><a href="../cmake.html">conan.tools.cmake</a> &raquo;</li>
        
      <li>CMakeToolchain</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/conan-io/docs/blob/develop2/reference/tools/cmake/cmaketoolchain.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
          <!--<select id="search" name="state" multiple="true" onchange="window.location = reldir + this.value;" style="width:90%"></select>
          <hr/>-->
          <!--<div class="admonition important">
            <p class="admonition-title">Announcement</p>
            <p>Recipe Hacking no. 2! Building on what we learnt during the first installment we will be working on more Conan 2.0 Migration! We'll start by reviewing some open pull requests and hopefully tackle a CMake example. <a
            href=https://jfrog.zoom.us/webinar/register/WN_grFhqH0yRBeIfJmBvQoPJw> Register here to attend.</a></p>
          </div>-->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cmaketoolchain">
<span id="conan-tools-cmaketoolchain"></span><span id="conan-cmake-toolchain"></span><h1>CMakeToolchain<a class="headerlink" href="#cmaketoolchain" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> is the toolchain generator for CMake. It produces the toolchain file that can be used in the
command line invocation of CMake with the <code class="docutils literal notranslate"><span class="pre">-DCMAKE_TOOLCHAIN_FILE=conan_toolchain.cmake</span></code>. This generator translates
the current package configuration, settings, and options, into CMake toolchain syntax.</p>
<p>It can be declared as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conan</span> <span class="kn">import</span> <span class="n">ConanFile</span>

<span class="k">class</span> <span class="nc">Pkg</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;CMakeToolchain&quot;</span>
</pre></div>
</div>
<p>Or fully instantiated in the <code class="docutils literal notranslate"><span class="pre">generate()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conan</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMakeToolchain</span>

<span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="s2">&quot;hello/0.1&quot;</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;CMakeDeps&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;fPIC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}</span>
    <span class="n">default_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;fPIC&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;MYVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MYVAR_VALUE&quot;</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="p">[</span><span class="s2">&quot;MYDEFINE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MYDEF_VALUE&quot;</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> is intended to run with the <code class="docutils literal notranslate"><span class="pre">CMakeDeps</span></code> dependencies generator. Please do not use other
CMake legacy generators (like <code class="docutils literal notranslate"><span class="pre">cmake</span></code>, or <code class="docutils literal notranslate"><span class="pre">cmake_paths</span></code>) with it.</p>
</div>
<div class="section" id="generated-files">
<h2>Generated files<a class="headerlink" href="#generated-files" title="Permalink to this headline">¶</a></h2>
<p>This will generate the following files after a <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> (or when building the package
in the cache) with the information provided in the <code class="docutils literal notranslate"><span class="pre">generate()</span></code> method as well as information
translated from the current <code class="docutils literal notranslate"><span class="pre">settings</span></code>:</p>
<ul>
<li><p class="first"><strong>conan_toolchain.cmake</strong>: containing the translation of Conan settings to CMake variables.
Some things that will be defined in this file:</p>
<ul class="simple">
<li>Definition of the CMake generator platform and generator toolset</li>
<li>Definition of the <code class="docutils literal notranslate"><span class="pre">CMAKE_POSITION_INDEPENDENT_CODE</span></code>, based on <code class="docutils literal notranslate"><span class="pre">fPIC</span></code> option.</li>
<li>Definition of the C++ standard as necessary</li>
<li>Definition of the standard library used for C++</li>
<li>Deactivation of rpaths in OSX</li>
</ul>
</li>
<li><p class="first"><strong>conanvcvars.bat</strong>: In some cases, the Visual Studio environment needs to be defined correctly for building,
like when using the Ninja or NMake generators. If necessary, the <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> will generate this script,
so defining the correct Visual Studio prompt is easier.</p>
</li>
<li><p class="first"><strong>CMakePresets.json</strong>: The toolchain also generates a <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code> standard file, check the documentation
<a class="reference external" href="https://cmake.org/cmake/help/latest/manual/cmake-presets.7.html">here</a>. It is currently using the version “3” of
the JSON schema.
Conan creates a <code class="docutils literal notranslate"><span class="pre">conan-default</span></code> configure preset with the information:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">generator</span></code> to be used.</li>
<li>The path to the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code>.</li>
<li>Some cache variables corresponding to the specified settings cannot work if specified in the toolchain.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE</span></code> variable when using a single-configuration generators.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">BUILD_TESTING</span></code> variable set to <code class="docutils literal notranslate"><span class="pre">OFF</span></code>, when configuration <code class="docutils literal notranslate"><span class="pre">tools.build:skip_test</span></code> is true.</li>
<li>If you run several <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> with different <code class="docutils literal notranslate"><span class="pre">-s</span> <span class="pre">build_type</span></code> values, it will generate the corresponding
<code class="docutils literal notranslate"><span class="pre">buildPresets</span></code> and <code class="docutils literal notranslate"><span class="pre">configurePresets</span></code>.</li>
<li>By default, the presets names will be <code class="docutils literal notranslate"><span class="pre">conan-xxxx</span></code>, but the “conan-” prefix can be customized with
<code class="docutils literal notranslate"><span class="pre">CMakeToolchain.presets_prefix</span> <span class="pre">=</span> <span class="pre">&quot;conan&quot;</span></code> attribute.</li>
<li>The preset names will be controlled by the <code class="docutils literal notranslate"><span class="pre">layout()</span></code> <code class="docutils literal notranslate"><span class="pre">self.folders.build_folder_vars</span></code> definition, that
can contain a list of settings and options like <code class="docutils literal notranslate"><span class="pre">[&quot;settings.compiler&quot;,</span> <span class="pre">&quot;settings.arch&quot;,</span> <span class="pre">&quot;options.shared&quot;]</span></code>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>CMakeUserPresets.json</strong>:  If you declare a <code class="docutils literal notranslate"><span class="pre">layout()</span></code> in the recipe and your
<code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file is found at the <code class="docutils literal notranslate"><span class="pre">conanfile.source_folder</span></code> folder, a
<code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> file will be generated (if doesn’t exist already) including
automatically the <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code> (at the <code class="docutils literal notranslate"><span class="pre">conanfile.generators_folder</span></code>) to
allow your IDE (Visual Studio, Visual Studio Code, CLion…) or <code class="docutils literal notranslate"><span class="pre">cmake</span></code> tool to locate
the <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code>. The location of the generated <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> can
be further tweaked by the <code class="docutils literal notranslate"><span class="pre">user_presets_path</span></code> attribute, as documented below. The
version schema of the generated <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> is “4” and requires CMake &gt;=
3.23.
The file name of this file can be configured with the <code class="docutils literal notranslate"><span class="pre">CMakeToolchain.user_presets_path</span> <span class="pre">=</span> <span class="pre">&quot;CMakeUserPresets.json&quot;`</span></code>
attribute, so if you want to generate a “ConanPresets.json” instead to be included from your own file,
you can define <code class="docutils literal notranslate"><span class="pre">tc.user_presets_path</span> <span class="pre">=</span> <span class="pre">&quot;ConanPresets.jon&quot;</span></code> in the <code class="docutils literal notranslate"><span class="pre">generate()</span></code> method.
See <a class="reference internal" href="../../../examples/tools/cmake/cmake_toolchain/extend_own_cmake_presets.html#examples-tools-cmake-toolchain-build-project-extend-presets"><span class="std std-ref">extending your own CMake presets</span></a> for a full example.</p>
<p>Note: Conan will skip the generation of the <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> if it already exists and was not
generated by Conan.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The version schema of the generated <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> is 4 (compatible
with CMake&gt;=3.23) and the schema for the <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code> is 3 (compatible with
CMake&gt;=3.21).</p>
</div>
</div>
<div class="section" id="customization">
<h2>Customization<a class="headerlink" href="#customization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preprocessor-definitions">
<h3>preprocessor_definitions<a class="headerlink" href="#preprocessor-definitions" title="Permalink to this headline">¶</a></h3>
<p>This attribute allows defining compiler preprocessor definitions, for multiple configurations (Debug, Release, etc).</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="p">[</span><span class="s2">&quot;MYDEF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="s2">&quot;MYCONFIGDEF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyDebugValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">preprocessor_definitions</span><span class="o">.</span><span class="n">release</span><span class="p">[</span><span class="s2">&quot;MYCONFIGDEF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyReleaseValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>This will be translated to:</p>
<ul class="simple">
<li>One <code class="docutils literal notranslate"><span class="pre">add_definitions()</span></code> definition for <code class="docutils literal notranslate"><span class="pre">MYDEF</span></code> in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li>One <code class="docutils literal notranslate"><span class="pre">add_definitions()</span></code> definition, using a cmake generator expression in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file,
using the different values for different configurations.</li>
</ul>
</div>
<div class="section" id="cache-variables">
<span id="conan-cmake-toolchain-cache-variables"></span><h3>cache_variables<a class="headerlink" href="#cache-variables" title="Permalink to this headline">¶</a></h3>
<p>This attribute allows defining CMake cache-variables. These variables, unlike the <code class="docutils literal notranslate"><span class="pre">variables</span></code>, are single-config. They
will be stored in the <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code> file (at the <cite>cacheVariables</cite> in the <cite>configurePreset</cite>) and will be
applied with <code class="docutils literal notranslate"><span class="pre">-D</span></code> arguments when calling <code class="docutils literal notranslate"><span class="pre">cmake.configure</span></code> using the <a class="reference internal" href="../cmake.html#conan-tools-cmake"><span class="std std-ref">CMake() build helper</span></a>.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">cache_variables</span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">cache_variables</span><span class="p">[</span><span class="s2">&quot;foo2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">cache_variables</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;23&quot;</span>
</pre></div>
</div>
<p>The booleans assigned to a cache_variable will be translated to <code class="docutils literal notranslate"><span class="pre">ON</span></code> and <code class="docutils literal notranslate"><span class="pre">OFF</span></code> symbols in CMake.</p>
</div>
<div class="section" id="variables">
<h3>variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p>This attribute allows defining CMake variables, for multiple configurations (Debug,
Release, etc). These variables should be used to define things related to the toolchain
and for the majority of cases
<a class="reference internal" href="#conan-cmake-toolchain-cache-variables"><span class="std std-ref">cache_variables</span></a> is what you probably want to
use. Also, take into account that as these variables are defined inside the
<em>conan_toolchain.cmake</em> file, and the toolchain is loaded several times by CMake, the
definition of these variables will be done at those points as well.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;MYVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="s2">&quot;MYCONFIGVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyDebugValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">release</span><span class="p">[</span><span class="s2">&quot;MYCONFIGVAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MyReleaseValue&quot;</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>This will be translated to:</p>
<ul class="simple">
<li>One <code class="docutils literal notranslate"><span class="pre">set()</span></code> definition for <code class="docutils literal notranslate"><span class="pre">MYVAR</span></code> in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li>One <code class="docutils literal notranslate"><span class="pre">set()</span></code> definition, using a cmake generator expression in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file,
using the different values for different configurations.</li>
</ul>
<p>The booleans assigned to a variable will be translated to <code class="docutils literal notranslate"><span class="pre">ON</span></code> and <code class="docutils literal notranslate"><span class="pre">OFF</span></code> symbols in CMake:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;FOO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;VAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>Will generate the sentences: <code class="docutils literal notranslate"><span class="pre">set(FOO</span> <span class="pre">ON</span> <span class="pre">...)</span></code> and <code class="docutils literal notranslate"><span class="pre">set(VAR</span> <span class="pre">OFF</span> <span class="pre">...)</span></code>.</p>
</div>
<div class="section" id="user-presets-path">
<h3>user_presets_path<a class="headerlink" href="#user-presets-path" title="Permalink to this headline">¶</a></h3>
<p>This attribute allows specifying the location of the generated <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> file.
Accepted values:</p>
<ul class="simple">
<li>An absolute path</li>
<li>A path relative to <code class="docutils literal notranslate"><span class="pre">self.source_folder</span></code></li>
<li>The boolean value <code class="docutils literal notranslate"><span class="pre">False</span></code>, to suppress the generation of the file altogether.</li>
</ul>
<p>For example, we can prevent the generator from creating <code class="docutils literal notranslate"><span class="pre">CMakeUserPresets.json</span></code> in the
following way:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">user_presets_path</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="presets-prefix">
<h3>presets_prefix<a class="headerlink" href="#presets-prefix" title="Permalink to this headline">¶</a></h3>
<p>By default it is <code class="docutils literal notranslate"><span class="pre">&quot;conan&quot;</span></code>, and it will generate CMake presets named “conan-xxxx”.
This is done to avoid potential name clashes with users own presets.</p>
</div>
<div class="section" id="using-a-custom-toolchain-file">
<h3>Using a custom toolchain file<a class="headerlink" href="#using-a-custom-toolchain-file" title="Permalink to this headline">¶</a></h3>
<p>There are two ways of providing custom CMake toolchain files:</p>
<ul>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file can be completely skipped and replaced by a user one, defining the
<code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:toolchain_file=&lt;filepath&gt;</span></code> configuration value.</p>
</li>
<li><p class="first">A custom user toolchain file can be added (included from) to the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> one, by using the
<code class="docutils literal notranslate"><span class="pre">user_toolchain</span></code> block described below, and defining the <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain=[&quot;&lt;filepath&gt;&quot;]</span></code>
configuration value.</p>
<p>The configuration <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain=[&quot;&lt;filepath&gt;&quot;]</span></code> can be defined in the <code class="docutils literal notranslate"><span class="pre">global.conf</span></code>.
but also creating a Conan package for your toolchain and using <code class="docutils literal notranslate"><span class="pre">self.conf_info</span></code> to declare the toolchain file:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">conan</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="k">class</span> <span class="nc">MyToolchainPackage</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">package_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">package_folder</span><span class="p">,</span> <span class="s2">&quot;mytoolchain.cmake&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conf_info</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="s2">&quot;tools.cmake.cmaketoolchain:user_toolchain&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">f</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
<p>If you declare the previous package as a <code class="docutils literal notranslate"><span class="pre">tool_require</span></code>, the toolchain will be automatically applied.</p>
</li>
<li><p class="first">If you have more than one <code class="docutils literal notranslate"><span class="pre">tool_requires</span></code> defined, you can easily append all the user toolchain values
together using the <code class="docutils literal notranslate"><span class="pre">append</span></code> method in each of them, for instance:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">conan</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="k">class</span> <span class="nc">MyToolRequire</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">package_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">package_folder</span><span class="p">,</span> <span class="s2">&quot;mytoolchain.cmake&quot;</span><span class="p">)</span>
        <span class="c1"># Appending the value to any existing one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conf_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;tools.cmake.cmaketoolchain:user_toolchain&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>So, they’ll be automatically applied by your <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> generator without writing any extra code:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conan</span> <span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMake</span>
<span class="k">class</span> <span class="nc">Pkg</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>
    <span class="n">exports_sources</span> <span class="o">=</span> <span class="s2">&quot;CMakeLists.txt&quot;</span>
    <span class="n">tool_requires</span> <span class="o">=</span> <span class="s2">&quot;toolchain1/0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;toolchain2/0.1&quot;</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;CMakeToolchain&quot;</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cmake</span> <span class="o">=</span> <span class="n">CMake</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">cmake</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="extending-and-advanced-customization">
<h2>Extending and advanced customization<a class="headerlink" href="#extending-and-advanced-customization" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> implements a powerful capability for extending and customizing the resulting toolchain file.</p>
<p>The contents are organized by <code class="docutils literal notranslate"><span class="pre">blocks</span></code> that can be customized. The following predefined blocks are available,
and added in this order:</p>
<ul>
<li><p class="first"><strong>user_toolchain</strong>: Allows to include user toolchains from the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.
If the configuration <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain=[&quot;xxxx&quot;,</span> <span class="pre">&quot;yyyy&quot;]</span></code> is defined, its values will be <code class="docutils literal notranslate"><span class="pre">include(xxx)\ninclude(yyyy)</span></code> as the
first lines in <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code>.</p>
</li>
<li><p class="first"><strong>generic_system</strong>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_NAME</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_VERSION</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_PROCESSOR</span></code>,
<code class="docutils literal notranslate"><span class="pre">CMAKE_GENERATOR_PLATFORM</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_GENERATOR_TOOLSET</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_C_COMPILER</span></code>,
<code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_COMPILER</span></code></p>
</li>
<li><p class="first"><strong>android_system</strong>: Defines <code class="docutils literal notranslate"><span class="pre">ANDROID_PLATFORM</span></code>, <code class="docutils literal notranslate"><span class="pre">ANDROID_STL</span></code>, <code class="docutils literal notranslate"><span class="pre">ANDROID_ABI</span></code> and includes <code class="docutils literal notranslate"><span class="pre">ANDROID_NDK_PATH/build/cmake/android.toolchain.cmake</span></code>
where <code class="docutils literal notranslate"><span class="pre">ANDROID_NDK_PATH</span></code> comes defined in <code class="docutils literal notranslate"><span class="pre">tools.android:ndk_path</span></code> configuration value.</p>
</li>
<li><p class="first"><strong>apple_system</strong>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_OSX_ARCHITECTURES</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_OSX_SYSROOT</span></code> for Apple systems.</p>
</li>
<li><p class="first"><strong>fpic</strong>: Defines the <code class="docutils literal notranslate"><span class="pre">CMAKE_POSITION_INDEPENDENT_CODE</span></code> when there is a <code class="docutils literal notranslate"><span class="pre">options.fPIC</span></code></p>
</li>
<li><p class="first"><strong>arch_flags</strong>: Defines C/C++ flags like <code class="docutils literal notranslate"><span class="pre">-m32,</span> <span class="pre">-m64</span></code> when necessary.</p>
</li>
<li><p class="first"><strong>linker_scripts</strong>: Defines the flags for any provided linker scripts.</p>
</li>
<li><p class="first"><strong>libcxx</strong>: Defines <code class="docutils literal notranslate"><span class="pre">-stdlib=libc++</span></code> flag when necessary as well as <code class="docutils literal notranslate"><span class="pre">_GLIBCXX_USE_CXX11_ABI</span></code>.</p>
</li>
<li><p class="first"><strong>vs_runtime</strong>: Defines the <code class="docutils literal notranslate"><span class="pre">CMAKE_MSVC_RUNTIME_LIBRARY</span></code> variable, as a generator expression for multiple configurations.</p>
</li>
<li><p class="first"><strong>cppstd</strong>: defines <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_STANDARD</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_EXTENSIONS</span></code></p>
</li>
<li><p class="first"><strong>parallel</strong>: defines <code class="docutils literal notranslate"><span class="pre">/MP</span></code> parallel build flag for Visual.</p>
</li>
<li><p class="first"><strong>cmake_flags_init</strong>: defines <code class="docutils literal notranslate"><span class="pre">CMAKE_XXX_FLAGS</span></code> variables based on previously defined Conan variables. The blocks above only define <code class="docutils literal notranslate"><span class="pre">CONAN_XXX</span></code> variables, and this block will define CMake ones like <code class="docutils literal notranslate"><span class="pre">set(CMAKE_CXX_FLAGS_INIT</span> <span class="pre">&quot;${CONAN_CXX_FLAGS}&quot;</span> <span class="pre">CACHE</span> <span class="pre">STRING</span> <span class="pre">&quot;&quot;</span> <span class="pre">FORCE)`</span></code>.</p>
</li>
<li><p class="first"><strong>try_compile</strong>: Stop processing the toolchain, skipping the blocks below this one, if <code class="docutils literal notranslate"><span class="pre">IN_TRY_COMPILE</span></code> CMake property is defined.</p>
</li>
<li><p class="first"><strong>find_paths</strong>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_FIND_PACKAGE_PREFER_CONFIG</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_MODULE_PATH</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_PREFIX_PATH</span></code> so the generated files from <code class="docutils literal notranslate"><span class="pre">CMakeDeps</span></code> are found.</p>
</li>
<li><p class="first"><strong>rpath</strong>: Defines <code class="docutils literal notranslate"><span class="pre">CMAKE_SKIP_RPATH</span></code>. By default it is disabled, and it is needed to define <code class="docutils literal notranslate"><span class="pre">self.blocks[&quot;rpath&quot;].skip_rpath=True</span></code> if you want to activate <code class="docutils literal notranslate"><span class="pre">CMAKE_SKIP_RPATH</span></code></p>
</li>
<li><p class="first"><strong>shared</strong>: defines <code class="docutils literal notranslate"><span class="pre">BUILD_SHARED_LIBS</span></code>.</p>
</li>
<li><p class="first"><strong>output_dirs</strong>: Define the <code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_XXX</span></code> variables.</p>
<blockquote>
<div><ul class="simple">
<li><strong>CMAKE_INSTALL_PREFIX</strong>: Is set with the <code class="docutils literal notranslate"><span class="pre">package_folder</span></code>, so if a “cmake install” operation is run, the artifacts go
to that location.</li>
<li><strong>CMAKE_INSTALL_BINDIR</strong>, <strong>CMAKE_INSTALL_SBINDIR</strong> and <strong>CMAKE_INSTALL_LIBEXECDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">bin</span></code>.</li>
<li><strong>CMAKE_INSTALL_LIBDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">lib</span></code>.</li>
<li><strong>CMAKE_INSTALL_INCLUDEDIR</strong> and <strong>CMAKE_INSTALL_OLDINCLUDEDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">include</span></code>.</li>
<li><strong>CMAKE_INSTALL_DATAROOTDIR</strong>: Set by default to <code class="docutils literal notranslate"><span class="pre">res</span></code>.</li>
</ul>
<p>If you want to change the default values, adjust the <code class="docutils literal notranslate"><span class="pre">cpp.package</span></code> object at the <code class="docutils literal notranslate"><span class="pre">layout()</span></code> method:</p>
<blockquote>
<div><div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="c1"># For CMAKE_INSTALL_BINDIR, CMAKE_INSTALL_SBINDIR and CMAKE_INSTALL_LIBEXECDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">bindirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mybin&quot;</span><span class="p">]</span>
    <span class="c1"># For CMAKE_INSTALL_LIBDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">libdirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mylib&quot;</span><span class="p">]</span>
    <span class="c1"># For CMAKE_INSTALL_INCLUDEDIR, CMAKE_INSTALL_OLDINCLUDEDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">includedirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;myinclude&quot;</span><span class="p">]</span>
    <span class="c1"># For CMAKE_INSTALL_DATAROOTDIR, takes the first value:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cpp</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">resdirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;myres&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is <strong>not valid</strong> to change the self.cpp_info  at the <code class="docutils literal notranslate"><span class="pre">package_info()</span></code> method.</p>
</div>
</div></blockquote>
</li>
</ul>
<div class="section" id="customizing-the-content-blocks">
<h3>Customizing the content blocks<a class="headerlink" href="#customizing-the-content-blocks" title="Permalink to this headline">¶</a></h3>
<p>Every block can be customized in different ways:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove an existing block</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;generic_system&quot;</span><span class="p">)</span>

<span class="c1"># modify the template of an existing block</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">template</span>
    <span class="n">new_tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># replace, fully replace, append...</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">new_tmp</span>

<span class="c1"># modify one or more variables of the context</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="n">conanfile</span><span class="p">)</span>
    <span class="c1"># block.values is the context dictionary</span>
    <span class="n">toolset</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;toolset&quot;</span><span class="p">]</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="s2">&quot;toolset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;other_toolset&quot;</span>

<span class="c1"># modify the whole context values</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="n">conanfile</span><span class="p">)</span>
    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;toolset&quot;</span><span class="p">:</span> <span class="s2">&quot;other_toolset&quot;</span><span class="p">}</span>

<span class="c1"># modify the context method of an existing block</span>
<span class="kn">import</span> <span class="nn">types</span>

<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">generic_block</span> <span class="o">=</span> <span class="n">toolchain</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span>  <span class="c1"># Your own custom logic here</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;toolset&quot;</span><span class="p">:</span> <span class="s2">&quot;other_toolset&quot;</span><span class="p">}</span>
    <span class="n">generic_block</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">generic_block</span><span class="p">)</span>

<span class="c1"># completely replace existing block</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMakeToolchain</span>

<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># this could go to a python_requires</span>
    <span class="k">class</span> <span class="nc">MyGenericBlock</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;HelloWorld&quot;</span>

        <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{}</span>

    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;generic_system&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MyGenericBlock</span>

<span class="c1"># add a completely new block</span>
<span class="kn">from</span> <span class="nn">conan.tools.cmake</span> <span class="kn">import</span> <span class="n">CMakeToolchain</span>
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">tc</span> <span class="o">=</span> <span class="n">CMakeToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># this could go to a python_requires</span>
    <span class="k">class</span> <span class="nc">MyBlock</span><span class="p">:</span>
        <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;Hello {{myvar}}!!!&quot;</span>

        <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;myvar&quot;</span><span class="p">:</span> <span class="s2">&quot;World&quot;</span><span class="p">}</span>

    <span class="n">tc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="s2">&quot;mynewblock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MyBlock</span>
</pre></div>
</div>
<p>For more information about these blocks, please have a look at the source code.</p>
</div>
</div>
<div class="section" id="cross-building">
<h2>Cross building<a class="headerlink" href="#cross-building" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">generic_system</span></code> block contains some basic cross-building capabilities. In the general
case, the user would want to provide their own user toolchain defining all the specifics,
which can be done with the configuration <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:user_toolchain</span></code>. If
this conf value is defined, the <code class="docutils literal notranslate"><span class="pre">generic_system</span></code> block will include the provided file or files, but
no further define any CMake variable for cross-building.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">user_toolchain</span></code> is not defined and Conan detects it is cross-building, because the build
and host profiles contain different OS or architecture, it will try to define the following
variables:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_NAME</span></code>: <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_name</span></code> configuration if
defined, otherwise, it will try to autodetect it. This block will consider
cross-building if Android systems (that is managed by other blocks), and not 64bits to
32bits builds in x86_64, sparc and ppc systems.</li>
<li><code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_VERSION</span></code>: <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_version</span></code> conf if defined, otherwise
<code class="docutils literal notranslate"><span class="pre">os.version</span></code> subsetting (host) when defined</li>
<li><code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_PROCESSOR</span></code>: <code class="docutils literal notranslate"><span class="pre">tools.cmake.cmaketoolchain:system_processor</span></code> conf if defined, otherwise
<code class="docutils literal notranslate"><span class="pre">arch</span></code> setting (host) if defined</li>
</ul>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="conan.tools.cmake.toolchain.toolchain.CMakeToolchain">
<em class="property">class </em><code class="descname">CMakeToolchain</code><span class="sig-paren">(</span><em>conanfile</em>, <em>generator=None</em><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.cmake.toolchain.toolchain.CMakeToolchain" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="conan.tools.cmake.toolchain.toolchain.CMakeToolchain.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.cmake.toolchain.toolchain.CMakeToolchain.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>This method will save the generated files to the conanfile.generators_folder</p>
</dd></dl>

</dd></dl>

<div class="section" id="conf">
<span id="conan-cmake-toolchain-conf"></span><h3>conf<a class="headerlink" href="#conf" title="Permalink to this headline">¶</a></h3>
<p>CMakeToolchain is affected by these <code class="docutils literal notranslate"><span class="pre">[conf]</span></code> variables:</p>
<ul class="simple">
<li><strong>tools.cmake.cmaketoolchain:toolchain_file</strong> user toolchain file to replace the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> one.</li>
<li><strong>tools.cmake.cmaketoolchain:user_toolchain</strong> list of user toolchains to be included from the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li><strong>tools.android:ndk_path</strong> value for <code class="docutils literal notranslate"><span class="pre">ANDROID_NDK_PATH</span></code>.</li>
<li><strong>tools.cmake.cmaketoolchain:system_name</strong> is not necessary in most cases and is only used to force-define <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_NAME</span></code>.</li>
<li><strong>tools.cmake.cmaketoolchain:system_version</strong> is not necessary in most cases and is only used to force-define <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_VERSION</span></code>.</li>
<li><strong>tools.cmake.cmaketoolchain:system_processor</strong> is not necessary in most cases and is only used to force-define <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSTEM_PROCESSOR</span></code>.</li>
<li><strong>tools.cmake.cmaketoolchain:toolset_arch</strong>: Will add the <code class="docutils literal notranslate"><span class="pre">,host=xxx</span></code> specifier in the <code class="docutils literal notranslate"><span class="pre">CMAKE_GENERATOR_TOOLSET</span></code> variable of <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> file.</li>
<li><strong>tools.cmake.cmake_layout:build_folder_vars</strong>: Settings and Options that will produce a different build folder and different CMake presets names.</li>
<li><strong>tools.build:cxxflags</strong> list of extra C++ flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_FLAGS_INIT</span></code>.</li>
<li><strong>tools.build:cflags</strong> list of extra of pure C flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_C_FLAGS_INIT</span></code>.</li>
<li><strong>tools.build:sharedlinkflags</strong> list of extra linker flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_SHARED_LINKER_FLAGS_INIT</span></code>.</li>
<li><strong>tools.build:exelinkflags</strong> list of extra linker flags that will be appended to <code class="docutils literal notranslate"><span class="pre">CMAKE_EXE_LINKER_FLAGS_INIT</span></code>.</li>
<li><strong>tools.build:defines</strong> list of preprocessor definitions that will be used by <code class="docutils literal notranslate"><span class="pre">add_definitions()</span></code>.</li>
<li><strong>tools.build:tools.apple:enable_bitcode</strong> boolean value to enable/disable Bitcode Apple Clang flags, e.g., <code class="docutils literal notranslate"><span class="pre">CMAKE_XCODE_ATTRIBUTE_ENABLE_BITCODE</span></code>.</li>
<li><strong>tools.build:tools.apple:enable_arc</strong> boolean value to enable/disable ARC Apple Clang flags, e.g., <code class="docutils literal notranslate"><span class="pre">CMAKE_XCODE_ATTRIBUTE_CLANG_ENABLE_OBJC_ARC</span></code>.</li>
<li><strong>tools.build:tools.apple:enable_visibility</strong> boolean value to enable/disable Visibility Apple Clang flags, e.g., <code class="docutils literal notranslate"><span class="pre">CMAKE_XCODE_ATTRIBUTE_GCC_SYMBOLS_PRIVATE_EXTERN</span></code>.</li>
<li><strong>tools.build:sysroot</strong> defines the value of <code class="docutils literal notranslate"><span class="pre">CMAKE_SYSROOT</span></code>.</li>
<li><strong>tools.build:compiler_executables</strong> dict-like Python object which specifies the
compiler as key and the compiler executable path as value. Those keys will be mapped as
follows:<ul>
<li><code class="docutils literal notranslate"><span class="pre">c</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_C_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">cpp</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">RC</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_RC_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">objc</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_OBJC_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">objcpp</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_OBJCXX_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">cuda</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_CUDA_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">fortran</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_Fortran_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">asm</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_ASM_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">hip</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_HIP_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">ispc</span></code>: will set <code class="docutils literal notranslate"><span class="pre">CMAKE_ISPC_COMPILER</span></code> in <em>conan_toolchain.cmake</em>.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cmake.html" class="btn btn-neutral float-right" title="CMake" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cmakedeps.html" class="btn btn-neutral" title="CMakeDeps" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2023, JFrog.
      Last updated on Mar 07, 2023.
      <span><a href="#" class="ot-sdk-show-settings">Cookies Settings</a></span>
    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <!--<span class="fa fa-pencil-square-o"> Other versions:</span> -->
      Version: 2.0
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
            
                <dd><a href="/2.0/index.html">2.0</a></dd>
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
                   
        
            
                <dd><a href="/2/index.html">2</a></dd>
                   
        
        <br>
        
                   
        
            
                <dd><a href="/1/index.html">1</a></dd>
                   
        
            
                <dd><a href="/en/1.59/index.html">1.59</a></dd>
                   
        
            
                <dd><a href="/en/1.58/index.html">1.58</a></dd>
                   
        
            
                <dd><a href="/en/1.57/index.html">1.57</a></dd>
                   
        
            
                <dd><a href="/en/1.56/index.html">1.56</a></dd>
                   
        
            
                <dd><a href="/en/1.55/index.html">1.55</a></dd>
                   
        
            
                <dd><a href="/en/1.54/index.html">1.54</a></dd>
                   
        
            
                <dd><a href="/en/1.53/index.html">1.53</a></dd>
                   
        
            
                <dd><a href="/en/1.52/index.html">1.52</a></dd>
                   
        
            
                <dd><a href="/en/1.51/index.html">1.51</a></dd>
                   
        
            
                <dd><a href="/en/1.50/index.html">1.50</a></dd>
                   
        
            
                <dd><a href="/en/1.49/index.html">1.49</a></dd>
                   
        
            
                <dd><a href="/en/1.48/index.html">1.48</a></dd>
                   
        
            
                <dd><a href="/en/1.47/index.html">1.47</a></dd>
                   
        
            
                <dd><a href="/en/1.46/index.html">1.46</a></dd>
                   
        
            
                <dd><a href="/en/1.45/index.html">1.45</a></dd>
                   
        
            
                <dd><a href="/en/1.44/index.html">1.44</a></dd>
                   
        
            
                <dd><a href="/en/1.43/index.html">1.43</a></dd>
                   
        
            
                <dd><a href="/en/1.42/index.html">1.42</a></dd>
                   
        
            
                <dd><a href="/en/1.41/index.html">1.41</a></dd>
                   
        
            
                <dd><a href="/en/1.40/index.html">1.40</a></dd>
                   
        
            
                <dd><a href="/en/1.39/index.html">1.39</a></dd>
                   
        
            
                <dd><a href="/en/1.38/index.html">1.38</a></dd>
                   
        
            
                <dd><a href="/en/1.37/index.html">1.37</a></dd>
                   
        
            
                <dd><a href="/en/1.36/index.html">1.36</a></dd>
                   
        
            
                <dd><a href="/en/1.35/index.html">1.35</a></dd>
                   
        
            
                <dd><a href="/en/1.34/index.html">1.34</a></dd>
                   
        
            
                <dd><a href="/en/1.33/index.html">1.33</a></dd>
                   
        
            
                <dd><a href="/en/1.32/index.html">1.32</a></dd>
                   
        
            
                <dd><a href="/en/1.31/index.html">1.31</a></dd>
                   
        
            
                <dd><a href="/en/1.30/index.html">1.30</a></dd>
                   
        
            
                <dd><a href="/en/1.29/index.html">1.29</a></dd>
                   
        
            
                <dd><a href="/en/1.28/index.html">1.28</a></dd>
                   
        
            
                <dd><a href="/en/1.27/index.html">1.27</a></dd>
                   
        
            
                <dd><a href="/en/1.26/index.html">1.26</a></dd>
                   
        
            
                <dd><a href="/en/1.25/index.html">1.25</a></dd>
                   
        
            
                <dd><a href="/en/1.24/index.html">1.24</a></dd>
                   
        
            
                <dd><a href="/en/1.23/index.html">1.23</a></dd>
                   
        
            
                <dd><a href="/en/1.22/index.html">1.22</a></dd>
                   
        
            
                <dd><a href="/en/1.21/index.html">1.21</a></dd>
                   
        
            
                <dd><a href="/en/1.20/index.html">1.20</a></dd>
                   
        
            
                <dd><a href="/en/1.19/index.html">1.19</a></dd>
                   
        
            
                <dd><a href="/en/1.18/index.html">1.18</a></dd>
                   
        
            
                <dd><a href="/en/1.17/index.html">1.17</a></dd>
                   
        
            
                <dd><a href="/en/1.16/index.html">1.16</a></dd>
                   
        
            
                <dd><a href="/en/1.15/index.html">1.15</a></dd>
                   
        
            
                <dd><a href="/en/1.14/index.html">1.14</a></dd>
                   
        
            
                <dd><a href="/en/1.13/index.html">1.13</a></dd>
                   
        
            
                <dd><a href="/en/1.12/index.html">1.12</a></dd>
                   
        
            
                <dd><a href="/en/1.11/index.html">1.11</a></dd>
                   
        
            
                <dd><a href="/en/1.10/index.html">1.10</a></dd>
                   
        
            
                <dd><a href="/en/1.9/index.html">1.9</a></dd>
                   
        
            
                <dd><a href="/en/1.8/index.html">1.8</a></dd>
                   
        
            
                <dd><a href="/en/1.7/index.html">1.7</a></dd>
                   
        
            
                <dd><a href="/en/1.6/index.html">1.6</a></dd>
                   
        
            
                <dd><a href="/en/1.5/index.html">1.5</a></dd>
                   
        
            
                <dd><a href="/en/1.4/index.html">1.4</a></dd>
                   
        
            
                <dd><a href="/en/1.3/index.html">1.3</a></dd>
                   
        
                   
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
            <dd><a href="/2.0/conan.pdf">PDF</a></dd> 
               
      </dl>
    </div>
  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'2.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  <!-- <script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
  <script src="../../../_static/js/modernizr.min.js"></script>
  <script src="../../../_static/js/search.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
-->
  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  


  <script>
    // initSearch("2.0");
  </script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK44ZFM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


 


</body>
</html>